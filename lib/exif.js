const _0x485d61=_0x31da;function _0x213d(){const _0x37511f=['writeFileSync','concat','unlinkSync','format','packname','EDRIC\x20Stickers','246GczYXH','utf-8','423684OcPNGX','mimetype','duration','hex','8hSfQuq','scale=min(','MB\x20limit','379381lZHojw','-an','Image','categories','error','435700RbcjZp','from','toFormat','-compression_level','iosLink','height','Media\x20too\x20large:\x20','packId',',ih):force_original_aspect_ratio=decrease','-preset','Video\x20conversion\x20error:','-quality','node-webpmux','addOutputOptions','run','emojis','Sticker\x20too\x20large:\x20','libwebp','codecData','-vf','writeUIntLE','.jpg','1061037sJPGHm','stringify','androidLink','data','-ss','6261827pstNPk','Image\x20conversion\x20error:','webp','test','toFixed','Invalid\x20media\x20object\x20provided','MB\x20exceeds\x20','output','length','existsSync','48945uidKZM','readFileSync','path','end','Video\x20conversion\x20failed:\x20','toString','load','2GkSKcc','-vcodec','message','fluent-ffmpeg','author','6svgIoP','save',',ih):force_original_aspect_ratio=decrease,fps=','quality','exif','maxSize','null','default','.webp','00:00:00','edric-sticker-pack','width','1926372PafTAL','EDRIC\x20Bot','dimensions'];_0x213d=function(){return _0x37511f;};return _0x213d();}(function(_0x3cf092,_0x13df0f){const _0x5b6704=_0x31da,_0x36c529=_0x3cf092();while(!![]){try{const _0x434bd2=-parseInt(_0x5b6704(0x14f))/0x1*(parseInt(_0x5b6704(0x180))/0x2)+parseInt(_0x5b6704(0x185))/0x3*(-parseInt(_0x5b6704(0x148))/0x4)+-parseInt(_0x5b6704(0x179))/0x5*(-parseInt(_0x5b6704(0x146))/0x6)+-parseInt(_0x5b6704(0x191))/0x7+parseInt(_0x5b6704(0x14c))/0x8*(parseInt(_0x5b6704(0x16a))/0x9)+parseInt(_0x5b6704(0x154))/0xa+parseInt(_0x5b6704(0x16f))/0xb;if(_0x434bd2===_0x13df0f)break;else _0x36c529['push'](_0x36c529['shift']());}catch(_0x57bca4){_0x36c529['push'](_0x36c529['shift']());}}}(_0x213d,0x40db2));const fs=require('fs'),{tmpdir}=require('os'),Crypto=require('crypto'),ff=require(_0x485d61(0x183)),webp=require(_0x485d61(0x160)),path=require(_0x485d61(0x17b)),STICKER_CONFIG={'maxSize':0x1*0x400*0x400,'maxDuration':0xa,'quality':0x50,'dimensions':{'width':0x200,'height':0x200},'fps':0xf};function generateTempFilename(_0x317165=''){const _0x34f799=_0x485d61;return path['join'](tmpdir(),''+Crypto['randomBytes'](0x8)[_0x34f799(0x17e)](_0x34f799(0x14b))+_0x317165);}function _0x31da(_0x17b1f6,_0x1b9c61){const _0x213d5d=_0x213d();return _0x31da=function(_0x31da90,_0x265b5f){_0x31da90=_0x31da90-0x145;let _0x20ba3e=_0x213d5d[_0x31da90];return _0x20ba3e;},_0x31da(_0x17b1f6,_0x1b9c61);}async function withTempCleanup(_0x134279,..._0x214c35){try{return await _0x134279();}finally{_0x214c35['forEach'](_0x586b4e=>{const _0x3d041e=_0x31da;if(_0x586b4e&&fs[_0x3d041e(0x178)](_0x586b4e))try{fs[_0x3d041e(0x196)](_0x586b4e);}catch(_0x1269b7){console['warn']('Failed\x20to\x20cleanup\x20temp\x20file:',_0x1269b7['message']);}});}}async function imageToWebp(_0x272c89,_0x49f7d8=STICKER_CONFIG['quality']){const _0x4e5e96=_0x485d61,_0x1cc0a6=generateTempFilename(_0x4e5e96(0x169)),_0x55a2a8=generateTempFilename('.webp');return await withTempCleanup(async()=>{const _0x4ba40f=_0x4e5e96;fs[_0x4ba40f(0x194)](_0x1cc0a6,_0x272c89),await new Promise((_0x245935,_0x21f384)=>{const _0x4eb216=_0x4ba40f;ff(_0x1cc0a6)['on'](_0x4eb216(0x153),_0x177d90=>{const _0x4dda98=_0x4eb216;console[_0x4dda98(0x153)](_0x4dda98(0x170),_0x177d90),_0x21f384(new Error('Image\x20conversion\x20failed:\x20'+_0x177d90[_0x4dda98(0x182)]));})['on'](_0x4eb216(0x17c),_0x245935)[_0x4eb216(0x161)]([_0x4eb216(0x181),_0x4eb216(0x165),_0x4eb216(0x167),_0x4eb216(0x14d)+STICKER_CONFIG['dimensions'][_0x4eb216(0x190)]+',iw):min('+STICKER_CONFIG[_0x4eb216(0x193)]['height']+_0x4eb216(0x15c),_0x4eb216(0x15f),_0x49f7d8[_0x4eb216(0x17e)](),'-compression_level','6',_0x4eb216(0x15d),'default'])[_0x4eb216(0x156)](_0x4eb216(0x171))['save'](_0x55a2a8);});const _0x3e5dda=fs[_0x4ba40f(0x17a)](_0x55a2a8);if(_0x3e5dda[_0x4ba40f(0x177)]>STICKER_CONFIG[_0x4ba40f(0x18a)])throw new Error(_0x4ba40f(0x164)+(_0x3e5dda[_0x4ba40f(0x177)]/0x400/0x400)[_0x4ba40f(0x173)](0x2)+_0x4ba40f(0x175)+STICKER_CONFIG[_0x4ba40f(0x18a)]/0x400/0x400+'MB\x20limit');return _0x3e5dda;},_0x1cc0a6,_0x55a2a8);}async function videoToWebp(_0xe416d7,_0x2350d0=STICKER_CONFIG[_0x485d61(0x188)]){const _0x4e133f=generateTempFilename('.mp4'),_0x3674ea=generateTempFilename('.webp');return await withTempCleanup(async()=>{const _0x26bb30=_0x31da;fs[_0x26bb30(0x194)](_0x4e133f,_0xe416d7),await new Promise((_0x32dfb4,_0x134534)=>{const _0x2c2fc2=_0x26bb30;ff(_0x4e133f)['on'](_0x2c2fc2(0x153),_0x555233=>{const _0x2d79a5=_0x2c2fc2;console['error'](_0x2d79a5(0x15e),_0x555233),_0x134534(new Error(_0x2d79a5(0x17d)+_0x555233[_0x2d79a5(0x182)]));})['on'](_0x2c2fc2(0x17c),_0x32dfb4)[_0x2c2fc2(0x161)]([_0x2c2fc2(0x181),_0x2c2fc2(0x165),_0x2c2fc2(0x167),'scale=min('+STICKER_CONFIG[_0x2c2fc2(0x193)][_0x2c2fc2(0x190)]+',iw):min('+STICKER_CONFIG['dimensions'][_0x2c2fc2(0x159)]+_0x2c2fc2(0x187)+STICKER_CONFIG['fps'],'-loop','0',_0x2c2fc2(0x16e),_0x2c2fc2(0x18e),'-t',STICKER_CONFIG['maxDuration'][_0x2c2fc2(0x17e)](),_0x2c2fc2(0x15f),_0x2350d0['toString'](),_0x2c2fc2(0x157),'4',_0x2c2fc2(0x15d),_0x2c2fc2(0x18c),_0x2c2fc2(0x150),'-vsync','0'])[_0x2c2fc2(0x156)](_0x2c2fc2(0x171))[_0x2c2fc2(0x186)](_0x3674ea);});const _0x2b565a=fs['readFileSync'](_0x3674ea);if(_0x2b565a[_0x26bb30(0x177)]>STICKER_CONFIG[_0x26bb30(0x18a)])throw new Error(_0x26bb30(0x164)+(_0x2b565a[_0x26bb30(0x177)]/0x400/0x400)[_0x26bb30(0x173)](0x2)+_0x26bb30(0x175)+STICKER_CONFIG[_0x26bb30(0x18a)]/0x400/0x400+_0x26bb30(0x14e));return _0x2b565a;},_0x4e133f,_0x3674ea);}async function writeExifImg(_0x3c095e,_0x414198={}){const _0x4eea83=_0x485d61,_0xe2add2=await imageToWebp(_0x3c095e),_0x1529d2=generateTempFilename(_0x4eea83(0x18d)),_0x3a86b7=generateTempFilename('.webp');return await withTempCleanup(async()=>{const _0x3cc90d=_0x4eea83;fs[_0x3cc90d(0x194)](_0x1529d2,_0xe2add2);if(_0x414198[_0x3cc90d(0x198)]||_0x414198[_0x3cc90d(0x184)]){const _0x59bcb2=new webp[(_0x3cc90d(0x151))](),_0x593168={'sticker-pack-id':_0x414198[_0x3cc90d(0x15b)]||_0x3cc90d(0x18f),'sticker-pack-name':_0x414198[_0x3cc90d(0x198)]||_0x3cc90d(0x145),'sticker-pack-publisher':_0x414198[_0x3cc90d(0x184)]||'EDRIC\x20Bot','emojis':_0x414198[_0x3cc90d(0x152)]||_0x414198['emojis']||[''],'android-app-store-link':_0x414198[_0x3cc90d(0x16c)]||'','ios-app-store-link':_0x414198[_0x3cc90d(0x158)]||''},_0x5d4655=Buffer[_0x3cc90d(0x155)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x31d2d8=Buffer[_0x3cc90d(0x155)](JSON[_0x3cc90d(0x16b)](_0x593168),_0x3cc90d(0x147)),_0x28bc15=Buffer[_0x3cc90d(0x195)]([_0x5d4655,_0x31d2d8]);return _0x28bc15[_0x3cc90d(0x168)](_0x31d2d8['length'],0xe,0x4),await _0x59bcb2[_0x3cc90d(0x17f)](_0x1529d2),_0x59bcb2[_0x3cc90d(0x189)]=_0x28bc15,await _0x59bcb2['save'](_0x3a86b7),fs[_0x3cc90d(0x17a)](_0x3a86b7);}return _0xe2add2;},_0x1529d2,_0x3a86b7);}async function writeExifVid(_0x55bbe5,_0x4cf6cb={}){const _0x1f76fe=_0x485d61,_0x55a519=await videoToWebp(_0x55bbe5),_0xd3c619=generateTempFilename(_0x1f76fe(0x18d)),_0x54b22a=generateTempFilename('.webp');return await withTempCleanup(async()=>{const _0x5ca631=_0x1f76fe;fs['writeFileSync'](_0xd3c619,_0x55a519);if(_0x4cf6cb['packname']||_0x4cf6cb[_0x5ca631(0x184)]){const _0x526a82=new webp[(_0x5ca631(0x151))](),_0x234b1f={'sticker-pack-id':_0x4cf6cb[_0x5ca631(0x15b)]||_0x5ca631(0x18f),'sticker-pack-name':_0x4cf6cb[_0x5ca631(0x198)]||_0x5ca631(0x145),'sticker-pack-publisher':_0x4cf6cb[_0x5ca631(0x184)]||_0x5ca631(0x192),'emojis':_0x4cf6cb[_0x5ca631(0x152)]||_0x4cf6cb[_0x5ca631(0x163)]||[''],'android-app-store-link':_0x4cf6cb[_0x5ca631(0x16c)]||'','ios-app-store-link':_0x4cf6cb[_0x5ca631(0x158)]||''},_0x2e9e95=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x3ddb2f=Buffer[_0x5ca631(0x155)](JSON['stringify'](_0x234b1f),_0x5ca631(0x147)),_0x37ad59=Buffer[_0x5ca631(0x195)]([_0x2e9e95,_0x3ddb2f]);return _0x37ad59[_0x5ca631(0x168)](_0x3ddb2f['length'],0xe,0x4),await _0x526a82[_0x5ca631(0x17f)](_0xd3c619),_0x526a82[_0x5ca631(0x189)]=_0x37ad59,await _0x526a82[_0x5ca631(0x186)](_0x54b22a),fs[_0x5ca631(0x17a)](_0x54b22a);}return _0x55a519;},_0xd3c619,_0x54b22a);}async function writeExif(_0x2049a7,_0x18d018={}){const _0x2a8329=_0x485d61;if(!_0x2049a7||!_0x2049a7[_0x2a8329(0x149)])throw new Error(_0x2a8329(0x174));let _0x299e7d;if(/webp/[_0x2a8329(0x172)](_0x2049a7['mimetype']))_0x299e7d=_0x2049a7[_0x2a8329(0x16d)];else{if(/image/[_0x2a8329(0x172)](_0x2049a7[_0x2a8329(0x149)]))_0x299e7d=await imageToWebp(_0x2049a7[_0x2a8329(0x16d)]);else{if(/video/[_0x2a8329(0x172)](_0x2049a7['mimetype']))_0x299e7d=await videoToWebp(_0x2049a7[_0x2a8329(0x16d)]);else throw new Error('Unsupported\x20media\x20type:\x20'+_0x2049a7[_0x2a8329(0x149)]);}}if(_0x18d018['packname']||_0x18d018[_0x2a8329(0x184)])return/video/[_0x2a8329(0x172)](_0x2049a7[_0x2a8329(0x149)])?await writeExifVid(_0x299e7d,_0x18d018):await writeExifImg(_0x299e7d,_0x18d018);return _0x299e7d;}function validateMedia(_0x144c99,_0x25c5df=STICKER_CONFIG[_0x485d61(0x18a)]){const _0x3ad1d0=_0x485d61;if(!_0x144c99)throw new Error('No\x20media\x20provided');if(_0x144c99[_0x3ad1d0(0x177)]>_0x25c5df)throw new Error(_0x3ad1d0(0x15a)+(_0x144c99[_0x3ad1d0(0x177)]/0x400/0x400)[_0x3ad1d0(0x173)](0x2)+'MB\x20exceeds\x20'+_0x25c5df/0x400/0x400+'MB\x20limit');return!![];}async function getMediaInfo(_0x11cf9e){return new Promise((_0x2e95e6,_0xd70d3)=>{const _0x1f8cc2=_0x31da;ff()['on'](_0x1f8cc2(0x153),_0xd70d3)['on'](_0x1f8cc2(0x166),_0x2c8cc6=>{const _0x36754f=_0x1f8cc2;_0x2e95e6({'format':_0x2c8cc6[_0x36754f(0x197)],'duration':_0x2c8cc6[_0x36754f(0x14a)],'size':_0x11cf9e['length'],'dimensions':_0x2c8cc6[_0x36754f(0x190)]+'x'+_0x2c8cc6[_0x36754f(0x159)]});})['input'](_0x11cf9e)[_0x1f8cc2(0x197)](_0x1f8cc2(0x18b))[_0x1f8cc2(0x176)]('-')[_0x1f8cc2(0x162)]();});}module['exports']={'imageToWebp':imageToWebp,'videoToWebp':videoToWebp,'writeExifImg':writeExifImg,'writeExifVid':writeExifVid,'writeExif':writeExif,'validateMedia':validateMedia,'getMediaInfo':getMediaInfo,'STICKER_CONFIG':STICKER_CONFIG};