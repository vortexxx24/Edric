const _0x286b10=_0x4f6a;(function(_0xf84362,_0x2a3569){const _0xebd149=_0x4f6a,_0x35ac74=_0xf84362();while(!![]){try{const _0x36d82b=parseInt(_0xebd149(0x1d8))/0x1+-parseInt(_0xebd149(0x1e2))/0x2+-parseInt(_0xebd149(0x1df))/0x3+-parseInt(_0xebd149(0x1ff))/0x4*(-parseInt(_0xebd149(0x1e6))/0x5)+-parseInt(_0xebd149(0x1e7))/0x6*(-parseInt(_0xebd149(0x202))/0x7)+-parseInt(_0xebd149(0x1ed))/0x8+-parseInt(_0xebd149(0x220))/0x9;if(_0x36d82b===_0x2a3569)break;else _0x35ac74['push'](_0x35ac74['shift']());}catch(_0x59e793){_0x35ac74['push'](_0x35ac74['shift']());}}}(_0x5d59,0x9f8dc));const {igdl}=require('ruhend-scraper'),axios=require(_0x286b10(0x1d7)),{exec}=require(_0x286b10(0x1ea)),fs=require('fs'),path=require('path'),webp=require(_0x286b10(0x21e)),crypto=require('crypto'),settings=require('../settings'),{stickercropFromBuffer}=require(_0x286b10(0x1e5));async function convertBufferToStickerWebp(_0x140278,_0x1d44a2,_0x11b8cd){const _0x235b3f=_0x286b10,_0x3f5210=path[_0x235b3f(0x20b)](process[_0x235b3f(0x211)](),_0x235b3f(0x1eb));if(!fs[_0x235b3f(0x1ee)](_0x3f5210))fs['mkdirSync'](_0x3f5210,{'recursive':!![]});const _0xac48c4=path[_0x235b3f(0x20b)](_0x3f5210,'igs_'+Date[_0x235b3f(0x21d)]()+'_'+Math['random']()[_0x235b3f(0x21f)](0x24)['slice'](0x2)),_0x22311a=_0x1d44a2?_0xac48c4+_0x235b3f(0x1f9):_0xac48c4+_0x235b3f(0x1f3),_0x504332=path[_0x235b3f(0x20b)](_0x3f5210,'igs_out_'+Date[_0x235b3f(0x21d)]()+'_'+Math[_0x235b3f(0x1f7)]()['toString'](0x24)[_0x235b3f(0x1e4)](0x2)+_0x235b3f(0x1fe));fs[_0x235b3f(0x229)](_0x22311a,_0x140278);const _0x3a6e96=[],_0x423820=_0x2d8970=>{if(!_0x2d8970)return;_0x3a6e96['push'](_0x2d8970),setTimeout(()=>{const _0x34caba=_0x4f6a;try{fs[_0x34caba(0x201)](_0x2d8970);}catch{}},0x1388);},_0x750fe9=_0x235b3f(0x1da),_0x4eaf8b='scale=512:512:force_original_aspect_ratio=decrease,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000';let _0x1ab80b;if(_0x1d44a2){const _0x5b3a47=_0x140278[_0x235b3f(0x20f)]>0x5*0x400*0x400,_0x3a17f0=_0x5b3a47?0x2:0x3;_0x11b8cd?_0x5b3a47?_0x1ab80b=_0x235b3f(0x1d0)+_0x22311a+_0x235b3f(0x1ec)+_0x504332+'\x22':_0x1ab80b='ffmpeg\x20-y\x20-i\x20\x22'+_0x22311a+_0x235b3f(0x205)+_0x504332+'\x22':_0x5b3a47?_0x1ab80b=_0x235b3f(0x1d0)+_0x22311a+_0x235b3f(0x1f8)+_0x504332+'\x22':_0x1ab80b='ffmpeg\x20-y\x20-i\x20\x22'+_0x22311a+'\x22\x20-t\x203\x20-vf\x20\x22scale=512:512:force_original_aspect_ratio=decrease,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,fps=12\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2045\x20-compression_level\x206\x20-b:v\x20150k\x20-max_muxing_queue_size\x201024\x20\x22'+_0x504332+'\x22';}else{const _0x5aae2d=(_0x11b8cd?_0x750fe9:_0x4eaf8b)+',format=rgba';_0x1ab80b=_0x235b3f(0x1d0)+_0x22311a+'\x22\x20-vf\x20\x22'+_0x5aae2d+_0x235b3f(0x222)+_0x504332+'\x22';}await new Promise((_0x5599b3,_0xe3148e)=>{exec(_0x1ab80b,(_0x5c3013,_0x4042d7,_0xf3e3ff)=>{if(_0x5c3013)return _0xe3148e(_0x5c3013);_0x5599b3();});});let _0xfbbd49=fs['readFileSync'](_0x504332);_0x423820(_0x504332);if(_0x1d44a2&&_0xfbbd49[_0x235b3f(0x20f)]>0x3e8*0x400)try{const _0x4bd406=path[_0x235b3f(0x20b)](_0x3f5210,'igs_out2_'+Date[_0x235b3f(0x21d)]()+'_'+Math[_0x235b3f(0x1f7)]()[_0x235b3f(0x21f)](0x24)[_0x235b3f(0x1e4)](0x2)+_0x235b3f(0x1fe)),_0xb15622=_0x11b8cd?_0x235b3f(0x1d0)+_0x22311a+_0x235b3f(0x1ec)+_0x4bd406+'\x22':_0x235b3f(0x1d0)+_0x22311a+'\x22\x20-t\x202\x20-vf\x20\x22scale=512:512:force_original_aspect_ratio=decrease,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,fps=8\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2035\x20-compression_level\x206\x20-b:v\x20100k\x20-max_muxing_queue_size\x201024\x20\x22'+_0x4bd406+'\x22';await new Promise((_0x40b7b0,_0x1b1a4b)=>{exec(_0xb15622,_0x482de7=>_0x482de7?_0x1b1a4b(_0x482de7):_0x40b7b0());}),fs[_0x235b3f(0x1ee)](_0x4bd406)&&(_0xfbbd49=fs[_0x235b3f(0x207)](_0x4bd406),_0x423820(_0x4bd406));}catch{}const _0x12f1d0=new webp['Image']();await _0x12f1d0[_0x235b3f(0x1e1)](_0xfbbd49);const _0x28bab3={'sticker-pack-id':crypto['randomBytes'](0x20)['toString'](_0x235b3f(0x1d9)),'sticker-pack-name':settings[_0x235b3f(0x1cc)]||_0x235b3f(0x213),'emojis':['üì∏']},_0x17d81a=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x128858=Buffer[_0x235b3f(0x21a)](JSON['stringify'](_0x28bab3),_0x235b3f(0x223)),_0xb840e5=Buffer[_0x235b3f(0x1fa)]([_0x17d81a,_0x128858]);_0xb840e5['writeUIntLE'](_0x128858[_0x235b3f(0x20f)],0xe,0x4),_0x12f1d0[_0x235b3f(0x224)]=_0xb840e5;let _0xa994f1=await _0x12f1d0[_0x235b3f(0x1fc)](null);if(_0xa994f1[_0x235b3f(0x20f)]>0x384*0x400)try{const _0x53b71d=path[_0x235b3f(0x20b)](_0x3f5210,_0x235b3f(0x1dd)+Date[_0x235b3f(0x21d)]()+'_'+Math[_0x235b3f(0x1f7)]()[_0x235b3f(0x21f)](0x24)[_0x235b3f(0x1e4)](0x2)+_0x235b3f(0x1fe)),_0x2e2c0b=_0x11b8cd?'crop=min(iw\x5c,ih):min(iw\x5c,ih),scale=320:320'+(_0x1d44a2?_0x235b3f(0x1d6):''):_0x235b3f(0x21c)+(_0x1d44a2?_0x235b3f(0x1d6):''),_0x3b337d=_0x235b3f(0x1d0)+_0x22311a+'\x22\x20'+(_0x1d44a2?_0x235b3f(0x1e3):'')+_0x235b3f(0x1e9)+_0x2e2c0b+_0x235b3f(0x214)+(_0x1d44a2?0x1c:0x41)+_0x235b3f(0x200)+_0x53b71d+'\x22';await new Promise((_0x312ca6,_0x22320e)=>{exec(_0x3b337d,_0x17d3dc=>_0x17d3dc?_0x22320e(_0x17d3dc):_0x312ca6());});if(fs['existsSync'](_0x53b71d)){const _0x5422b6=fs[_0x235b3f(0x207)](_0x53b71d),_0x2d6a76=new webp['Image']();await _0x2d6a76[_0x235b3f(0x1e1)](_0x5422b6);const _0x9fad11={'sticker-pack-id':crypto['randomBytes'](0x20)[_0x235b3f(0x21f)](_0x235b3f(0x1d9)),'sticker-pack-name':settings['packname']||_0x235b3f(0x213),'emojis':['üì∏']},_0x16a971=Buffer[_0x235b3f(0x21a)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x110792=Buffer[_0x235b3f(0x21a)](JSON[_0x235b3f(0x1f1)](_0x9fad11),_0x235b3f(0x223)),_0x3d7180=Buffer['concat']([_0x16a971,_0x110792]);_0x3d7180[_0x235b3f(0x218)](_0x110792[_0x235b3f(0x20f)],0xe,0x4),_0x2d6a76[_0x235b3f(0x224)]=_0x3d7180,_0xa994f1=await _0x2d6a76[_0x235b3f(0x1fc)](null),_0x423820(_0x53b71d);}}catch{}return _0x423820(_0x22311a),_0xa994f1;}function _0x4f6a(_0x5d7eef,_0x588480){const _0x5d59c6=_0x5d59();return _0x4f6a=function(_0x4f6ac5,_0x665dc7){_0x4f6ac5=_0x4f6ac5-0x1cb;let _0x5a15f4=_0x5d59c6[_0x4f6ac5];return _0x5a15f4;},_0x4f6a(_0x5d7eef,_0x588480);}function _0x5d59(){const _0x142e09=['extendedTextMessage','crop=min(iw\x5c,ih):min(iw\x5c,ih),scale=256:256','test','ffmpeg\x20-y\x20-i\x20\x22','sendMessage','catch','end','text','message',',fps=8','axios','682135GnbVoL','hex','crop=min(iw\x5c,ih):min(iw\x5c,ih),scale=512:512','identity','data','igs_out3_','randomBytes','162528XJZmNP','mkdirSync','load','2609052RwNHEe','-t\x202','slice','./stickercrop','5BEklSQ','42MzTtkP','mini_','\x20-vf\x20\x22','child_process','tmp','\x22\x20-t\x202\x20-vf\x20\x22crop=min(iw\x5c,ih):min(iw\x5c,ih),scale=512:512,fps=8\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2030\x20-compression_level\x206\x20-b:v\x20100k\x20-max_muxing_queue_size\x201024\x20\x22','2813768jIweBx','existsSync','‚ùå\x20Failed\x20to\x20fetch\x20media\x20from\x20Instagram\x20link.','has','stringify','url','.jpg','get','key','\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2025\x20-compression_level\x206\x20-b:v\x2060k\x20\x22','random','\x22\x20-t\x202\x20-vf\x20\x22scale=512:512:force_original_aspect_ratio=decrease,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,fps=8\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2035\x20-compression_level\x206\x20-b:v\x20100k\x20-max_muxing_queue_size\x201024\x20\x22','.mp4','concat','mini_out_','save','Error\x20in\x20igs\x20command:','.webp','4438972UnuGOA','\x20-compression_level\x206\x20-b:v\x2080k\x20-max_muxing_queue_size\x201024\x20\x22','unlinkSync','815129QwuRNW','scale=256:256:force_original_aspect_ratio=decrease,pad=256:256:(ow-iw)/2:(oh-ih)/2:color=#00000000','createHash','\x22\x20-t\x203\x20-vf\x20\x22crop=min(iw\x5c,ih):min(iw\x5c,ih),scale=512:512,fps=12\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2050\x20-compression_level\x206\x20-b:v\x20150k\x20-max_muxing_queue_size\x201024\x20\x22','match','readFileSync','forceMiniSticker\x20error:','push','mp4','join','IGS\x20item\x20error:','*/*','Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/124.0.0.0\x20Safari/537.36','length','add','cwd','type','Edric\x20OS','\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x20','conversation','min','Image','writeUIntLE','jpg','from','error','scale=320:320:force_original_aspect_ratio=decrease,pad=320:320:(ow-iw)/2:(oh-ih)/2:color=#00000000','now','node-webpmux','toString','2187468avQpfs','exports','\x22\x20-c:v\x20libwebp\x20-preset\x20default\x20-loop\x200\x20-vsync\x200\x20-pix_fmt\x20yuva420p\x20-quality\x2075\x20-compression_level\x206\x20\x22','utf8','exif','update','Send\x20an\x20Instagram\x20post/reel\x20link.\x0aUsage:\x0a.igs\x20<url>\x0a.igsc\x20<url>','arraybuffer','digest','writeFileSync',',fps=6','packname'];_0x5d59=function(){return _0x142e09;};return _0x5d59();}async function fetchBufferFromUrl(_0x4a828c){const _0x1629b4=_0x286b10;try{const _0x55891a=await axios['get'](_0x4a828c,{'responseType':_0x1629b4(0x227),'headers':{'User-Agent':_0x1629b4(0x20e),'Accept':'*/*','Accept-Encoding':_0x1629b4(0x1db)},'timeout':0x7530,'maxContentLength':Infinity,'maxBodyLength':Infinity,'decompress':!![],'validateStatus':_0x3b6ded=>_0x3b6ded>=0xc8&&_0x3b6ded<0x190});return Buffer[_0x1629b4(0x21a)](_0x55891a['data']);}catch(_0x4dd07b){try{const _0xf9af8e=await axios[_0x1629b4(0x1f4)](_0x4a828c,{'responseType':'stream','headers':{'User-Agent':_0x1629b4(0x20e),'Accept':_0x1629b4(0x20d),'Accept-Encoding':_0x1629b4(0x1db)},'timeout':0x9c40,'maxContentLength':Infinity,'maxBodyLength':Infinity,'validateStatus':_0x1e98d3=>_0x1e98d3>=0xc8&&_0x1e98d3<0x190}),_0x47e43d=[];return await new Promise((_0x12f2dc,_0x3644c0)=>{const _0x109282=_0x1629b4;_0xf9af8e['data']['on'](_0x109282(0x1dc),_0x111746=>_0x47e43d[_0x109282(0x209)](_0x111746)),_0xf9af8e[_0x109282(0x1dc)]['on'](_0x109282(0x1d3),_0x12f2dc),_0xf9af8e['data']['on']('error',_0x3644c0);}),Buffer[_0x1629b4(0x1fa)](_0x47e43d);}catch(_0x3194a4){console[_0x1629b4(0x21b)]('Both\x20axios\x20download\x20attempts\x20failed:',_0x4dd07b?.['message']||_0x4dd07b,_0x3194a4?.[_0x1629b4(0x1d5)]||_0x3194a4);throw _0x3194a4;}}}async function igsCommand(_0x50fa9c,_0x52501d,_0x64f2e7,_0x6385ef=![]){const _0x1ef766=_0x286b10;try{const _0x373068=_0x64f2e7[_0x1ef766(0x1d5)]?.[_0x1ef766(0x215)]||_0x64f2e7[_0x1ef766(0x1d5)]?.[_0x1ef766(0x1cd)]?.[_0x1ef766(0x1d4)]||'',_0x43266f=_0x373068[_0x1ef766(0x206)](/https?:\/\/\S+/);if(!_0x43266f){await _0x50fa9c[_0x1ef766(0x1d1)](_0x52501d,{'text':_0x1ef766(0x226)},{'quoted':_0x64f2e7});return;}await _0x50fa9c[_0x1ef766(0x1d1)](_0x52501d,{'react':{'text':'üîÑ','key':_0x64f2e7[_0x1ef766(0x1f5)]}});const _0x10467b=await igdl(_0x43266f[0x0])[_0x1ef766(0x1d2)](()=>null);if(!_0x10467b||!_0x10467b[_0x1ef766(0x1dc)]){await _0x50fa9c[_0x1ef766(0x1d1)](_0x52501d,{'text':_0x1ef766(0x1ef)},{'quoted':_0x64f2e7});return;}const _0x5972ad=(_0x10467b?.[_0x1ef766(0x1dc)]||[])['filter'](_0x16e24f=>_0x16e24f&&_0x16e24f[_0x1ef766(0x1f2)]),_0x4d525c=new Set(),_0x3c313c=[];for(const _0x9cc1d7 of _0x5972ad){!_0x4d525c[_0x1ef766(0x1f0)](_0x9cc1d7[_0x1ef766(0x1f2)])&&(_0x4d525c[_0x1ef766(0x210)](_0x9cc1d7[_0x1ef766(0x1f2)]),_0x3c313c[_0x1ef766(0x209)](_0x9cc1d7));}if(_0x3c313c[_0x1ef766(0x20f)]===0x0){await _0x50fa9c[_0x1ef766(0x1d1)](_0x52501d,{'text':'‚ùå\x20No\x20media\x20found\x20at\x20the\x20provided\x20link.'},{'quoted':_0x64f2e7});return;}const _0x516146=Math[_0x1ef766(0x216)](_0x3c313c['length'],0xa),_0xe0587b=new Set();for(let _0x50cdf2=0x0;_0x50cdf2<_0x516146;_0x50cdf2++){try{const _0x3f83a5=_0x3c313c[_0x50cdf2],_0x24cc87=_0x3f83a5[_0x1ef766(0x1f2)],_0x2caf66=_0x3f83a5?.[_0x1ef766(0x212)]==='video'||/\.(mp4|mov|avi|mkv|webm)$/i[_0x1ef766(0x1cf)](_0x24cc87),_0x131944=await fetchBufferFromUrl(_0x24cc87),_0x570144=require('crypto')[_0x1ef766(0x204)]('sha1')[_0x1ef766(0x225)](_0x131944)[_0x1ef766(0x228)](_0x1ef766(0x1d9));if(_0xe0587b[_0x1ef766(0x1f0)](_0x570144))continue;_0xe0587b['add'](_0x570144);let _0x366abe=_0x6385ef?await stickercropFromBuffer(_0x131944,_0x2caf66):await convertBufferToStickerWebp(_0x131944,_0x2caf66,![]),_0x48522a=_0x366abe;if(_0x48522a[_0x1ef766(0x20f)]>0x384*0x400)try{const _0x35a01e=await forceMiniSticker(_0x131944,_0x2caf66,_0x6385ef);_0x35a01e&&_0x35a01e[_0x1ef766(0x20f)]<=0x384*0x400&&(_0x48522a=_0x35a01e);}catch(_0x3aaeac){console[_0x1ef766(0x21b)](_0x1ef766(0x208),_0x3aaeac);}await _0x50fa9c[_0x1ef766(0x1d1)](_0x52501d,{'sticker':_0x48522a},{'quoted':_0x64f2e7}),_0x50cdf2<_0x516146-0x1&&await new Promise(_0x19ebdf=>setTimeout(_0x19ebdf,0x320));}catch(_0x1d1259){console[_0x1ef766(0x21b)](_0x1ef766(0x20c),_0x1d1259);}}}catch(_0x287405){console['error'](_0x1ef766(0x1fd),_0x287405),await _0x50fa9c[_0x1ef766(0x1d1)](_0x52501d,{'text':'Failed\x20to\x20create\x20sticker\x20from\x20Instagram\x20link.'},{'quoted':_0x64f2e7});}}async function forceMiniSticker(_0x95b3ca,_0x5ed2bd,_0x35e4f2){const _0x157fd8=_0x286b10,_0x5d0898=path[_0x157fd8(0x20b)](process['cwd'](),_0x157fd8(0x1eb));if(!fs[_0x157fd8(0x1ee)](_0x5d0898))fs[_0x157fd8(0x1e0)](_0x5d0898,{'recursive':!![]});const _0x4a4dd3=path[_0x157fd8(0x20b)](_0x5d0898,_0x157fd8(0x1e8)+Date[_0x157fd8(0x21d)]()+'.'+(_0x5ed2bd?_0x157fd8(0x20a):_0x157fd8(0x219))),_0x5f445a=path[_0x157fd8(0x20b)](_0x5d0898,_0x157fd8(0x1fb)+Date[_0x157fd8(0x21d)]()+_0x157fd8(0x1fe));fs[_0x157fd8(0x229)](_0x4a4dd3,_0x95b3ca);const _0x3be753=_0x35e4f2?_0x157fd8(0x1ce)+(_0x5ed2bd?_0x157fd8(0x1cb):''):_0x157fd8(0x203)+(_0x5ed2bd?',fps=6':''),_0x4a9c10=_0x157fd8(0x1d0)+_0x4a4dd3+'\x22\x20'+(_0x5ed2bd?_0x157fd8(0x1e3):'')+_0x157fd8(0x1e9)+_0x3be753+_0x157fd8(0x1f6)+_0x5f445a+'\x22';await new Promise((_0x7ece0f,_0x273d9d)=>{exec(_0x4a9c10,_0x491465=>_0x491465?_0x273d9d(_0x491465):_0x7ece0f());});if(!fs[_0x157fd8(0x1ee)](_0x5f445a)){try{fs[_0x157fd8(0x201)](_0x4a4dd3);}catch{}return null;}const _0x2a4bb3=fs['readFileSync'](_0x5f445a),_0x2bbe46=new webp[(_0x157fd8(0x217))]();await _0x2bbe46[_0x157fd8(0x1e1)](_0x2a4bb3);const _0x1976f0={'sticker-pack-id':crypto[_0x157fd8(0x1de)](0x20)[_0x157fd8(0x21f)](_0x157fd8(0x1d9)),'sticker-pack-name':settings[_0x157fd8(0x1cc)]||'Edric\x20OS','emojis':['üì∏']},_0x4cbf48=Buffer[_0x157fd8(0x21a)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x159a28=Buffer[_0x157fd8(0x21a)](JSON[_0x157fd8(0x1f1)](_0x1976f0),_0x157fd8(0x223)),_0x586114=Buffer[_0x157fd8(0x1fa)]([_0x4cbf48,_0x159a28]);_0x586114['writeUIntLE'](_0x159a28[_0x157fd8(0x20f)],0xe,0x4),_0x2bbe46['exif']=_0x586114;const _0x524c64=await _0x2bbe46[_0x157fd8(0x1fc)](null);try{fs[_0x157fd8(0x201)](_0x4a4dd3);}catch{}try{fs[_0x157fd8(0x201)](_0x5f445a);}catch{}return _0x524c64;}module[_0x286b10(0x221)]={'igsCommand':igsCommand};